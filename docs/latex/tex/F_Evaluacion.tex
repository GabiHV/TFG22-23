\apendice{Evaluación}

\section{Introducción}
En esta fase se estima el rendimiento de los diferentes modelos, y, en su caso, 
se reconsideran los objetivos del proyecto, de manera que, si estos son poco efectivos,
se vuelve a la primera fase.

En todas las redes neuronales se ha empleado validación cruzada externa y, además, se realizarán
diferentes ejecuciones con diversos parámetros para conocer el rendimiento de estas, a 
la par que poder eliminar en cierta medida el efecto del azar en los modelos 
resultantes.

Para validarlos se realizarán pruebas variando el número de capas
ocultas, así como el de celdas/neuronas en cada una de estas y el ratio de aprendizaje.
De esta manera, se realizarán combinaciones con 1, 2 y 3 capas en cada uno de los modelos, 
así como 32, 16 y 8 celdas/neuronas y 0.1, 0.01 y 0.001 de ratio de aprendizaje. 

Por otro lado, se ha dividido el conjunto de datos original en un conjunto de entrenamiento del 75\% de los disponibles
por sensor, 15\% para validación siendo el restante de test.

Con respecto al número de muestras de entrada se emplearán 6 horas previas para realizar
una predicción, empleando un tamaño de bloque de 256 ejemplos (los modelos 
no se entrenan con todos los datos en todas las iteraciones, sino que se emplean un subconjunto).
En la salida, por otro lado, se realizarán predicciones de 1, 2 y 3 horas (marcadas como MSE 1, MSE 2 y MSE 3 en las
respectivas tablas).

Además, se emplea un planificador de la tasa de aprendizaje, de forma
que en la época 50 disminuye multiplicando \(lr * e^{-0.1}\), para, de esta manera,
centrar los esfuerzos en la región explorada.

Para cada una de las pruebas se realizarán 5 ejecuciones diferentes con 100 iteraciones, 
tomando como medida comparativa el error cuadrático medio de validación.
Lo que supone 405 ejecuciones por modelo, es decir, 1215 ejecuciones en total.

\newpage

\section{Resultados de GRU}
En la Tabla \ref{tabla:Evaluación GRU} se presentan los errores cuadráticos medios
que se obtendrán para cada una de las pruebas. En esta se puede observar los resultados obtenidos con 1, 2 y 3 predicciones 
como salida de los modelos. 

\tablaSmallSinColores{Evaluación GRU}{l l l l l l}{Evaluación GRU}{\textbf{Capas} & \textbf{Tamaño capa} & \textbf{LR} & \textbf{MSE 1} & \textbf{MSE 2} & \textbf{MSE 3}\\}
{
    1 & 8 & 0.001 & 1.72183E-05 & 3.98320E-05 & 5.84809E-05 \\
    1 & 8 & 0.01 & 3.37952E-06 & 7.99268E-06 & 1.41913E-05\\
    1 & 8 & 0.1 & 0.00551 & 0.00127 & 0.00188 \\
    1 & 16 & 0.001 & 9.1907E-06 & 1.73932E-05 & 3.24371E-05 \\
    1 & 16 & 0.01 & 9.55771E-07 & 2.96765E-06 & 7.32603E-06 \\
    1 & 16 & 0.1 & 0.00474 & 0.00718 & 0.00138 \\
    1 & 32 & 0.001 & 4.50204E-06 & 1.22795E-05 & 2.51439E-05 \\
    1 & 32 & 0.01 & \textbf{5.96471E-07} & 1.69264E-06 & 4.50310E-06 \\
    1 & 32 & 0.1 & 0.00297 & 0.00158 & 0.00175 \\

    % 2 capas ocultas
    2 & 8 & 0.001 & 1.56769E-05 & 2.90745E-05 & 4.93188E-05 \\
    2 & 8 & 0.01 & 1.65277E-06 & 6.30449E-06 & 1.14688E-05 \\
    2 & 8 & 0.1 & 0.00965 & 0.00972 & 0.00026 \\
    2 & 16 & 0.001 & 5.07987E-06 & 1.33184E-05 & 2.59817E-05 \\
    2 & 16 & 0.01 & \textbf{5.66822E-07} & \textbf{1.45485E-06} & \textbf{3.49998E-06} \\
    2 & 16 & 0.1 & 0.01148 & 0.01579 & 0.00363 \\
    2 & 32 & 0.001 & 2.18717E-06 & 7.23831E-06 & 1.42593E-05 \\
    2 & 32 & 0.01 & \textbf{2.69205E-07} & \textbf{9.00049E-07} & \textbf{4.04636E-06} \\
    2 & 32 & 0.1 & 0.01727 & 0.00611 & 0.00797 \\

    % 3 capas ocultas
    3 & 8 & 0.001 & 1.61179E-05 & 2.57331E-05 & 4.20175E-05 \\
    3 & 8 & 0.01 & 1.42658E-06 & 5.39812E-06 & 9.51720E-06 \\
    3 & 8 & 0.1 & 0.00706 & 0.00029 & 0.00242 \\
    3 & 16 & 0.001 & 5.18860E-06 & 1.23398E-05 & 2.02378E-05 \\
    3 & 16 & 0.01 & \textbf{4.66034E-07} & \textbf{1.29760E-06} & \textbf{3.49093E-06}\\
    3 & 16 & 0.1 & 0.02418 & 0.01457 & 0.01497\\
    3 & 32 & 0.001 & 2.36664E-06 & 5.75822E-06 & 1.13415E-05\\
    3 & 32 & 0.01 & 8.90246E-07 & \textbf{9.57532E-07} & \textbf{2.41350E-06}\\
    3 & 32 & 0.1 & 0.00976 & 0.01064 & 0.01097\\
}

Como puede observarse, las mayores eficiencias en términos generales se obtienen 
con un \textit{learning rate} de 0.01, destacando los modelos de 2 capas con 
32 y 16 celdas de memoria respectivamente.

Cabe destacar, además, que, como se podía intuir inicialmente, los errores aumentan generalmente
a medida que realizamos más predicciones como salida.

\newpage

\section{Resultados de LSTM}
Al igual que en la situación anterior, se realizarán pruebas con el mismo número de predicciones
por cada entrada, obteniéndose los resultados reflejados en la Tabla \ref{tabla:Evaluación LSTM}.

\tablaSmallSinColores{Evaluación LSTM}{l l l l l l}{Evaluación LSTM}{\textbf{Capas} & \textbf{Tamaño capa} & \textbf{LR} & \textbf{MSE 1} & \textbf{MSE 2} & \textbf{MSE 3}\\}
{
    1 & 8 & 0.001 & 2.12520E-05 & 3.03812E-05 & 5.60944E-05 \\
    1 & 8 & 0.01 & 3.4556E-06 & 1.05315E-05 & 1.68195E-05 \\
    1 & 8 & 0.1 & 3.9049E-06 & 2.55932E-05 & 2.56167E-05 \\
    1 & 16 & 0.001 & 1.18867E-05 & 1.98377E-05 & 4.04516E-05 \\
    1 & 16 & 0.01 & 1.31837E-06 & 3.46421E-06 & 7.71354E-06 \\
    1 & 16 & 0.1 & 3.14115E-06 & 7.24853E-06 & 7.55877E-05 \\
    1 & 32 & 0.001 & 5.84463E-06 & 1.46677E-05 & 2.83427E-05 \\
    1 & 32 & 0.01 & \textbf{6.62421E-07} & \textbf{1.96414E-06} & 5.22169E-06 \\
    1 & 32 & 0.1 & \textbf{9.51891E-07} & 0.00011 & 1.05361E-05 \\

    % 2 capas ocultas
    2 & 8 & 0.001 & 3.29916E-05 & 4.19003E-05 & 6.14671E-05 \\
    2 & 8 & 0.01 & 4.94574E-06 & 8.51327E-06 & 1.33202E-05 \\
    2 & 8 & 0.1 & 6.85972E-06 & 8.04903E-06 & 1.58783E-05 \\
    2 & 16 & 0.001 & 1.33461E-05 & 2.75447E-05 & 4.1725E-05 \\
    2 & 16 & 0.01 & 1.23340E-06 & \textbf{2.38821E-06} & \textbf{4.63577E-06} \\
    2 & 16 & 0.1 & 6.65626E-06 & 2.42052E-05 & 1.43046E-05 \\
    2 & 32 & 0.001 & 5.63944E-06 & 1.15909E-05 & 2.34114E-05 \\
    2 & 32 & 0.01 & \textbf{4.56945E-07} & \textbf{1.43223E-06} & \textbf{2.78594E-06}\\
    2 & 32 & 0.1 & 4.20038E-06 & 1.00814E-05 & 7.57666E-05\\

    % 3 capas ocultas
    3 & 8 & 0.001 & 4.58400E-06 & 5.81849E-05 & 0.00012 \\
    3 & 8 & 0.01 & 5.90159E-06 & 9.07351E-06 & 1.48364E-05 \\
    3 & 8 & 0.1 & 0.00031 & 0.00486 & 1.73157E-05 \\
    3 & 16 & 0.001 & 2.22344E-05 & 3.47894E-05 & 5.07083E-05 \\
    3 & 16 & 0.01 & 1.17654E-06 & 2.41703E-06 & \textbf{4.06992E-06} \\
    3 & 16 & 0.1 & 0.00487 & 1.02880E-05 & 0.00490 \\
    3 & 32 & 0.001 & 8.16043E-06 & 1.64882E-05 & 2.57956E-05 \\
    3 & 32 & 0.01 & \textbf{6.54021E-07} & \textbf{1.19201E-06} & \textbf{2.58606E-06} \\
    3 & 32 & 0.1 & 0.00491 & 0.01459 & 0.00986 \\
}

De forma similar que en \textit{GRU}, en \textit{LSMT} se generan mejores resultados con un 
\textit{learning rate} de 0.01, destacando, de igual forma, los modelos con 2 capas, además
de los de 3 capas y 32 celdas de memoria.
Al igual que antes, los errores se incrementan, generalmente, con el aumento del número de predicciones.

\newpage

\section{Resultados de MLP}
En la Tabla \ref{tabla:Evaluación MLP} se proporcionan los diferentes resultados obtenidos con \textit{MLP}.

\tablaSmallSinColores{Evaluación MLP}{l l l l l l}{Evaluación MLP}{\textbf{Capas} & \textbf{Tamaño capa} & \textbf{LR} & \textbf{MSE 1} & \textbf{MSE 2} & \textbf{MSE 3} \\}
{
    1 & 8 & 0.001 & 0.00076 & 0.00017 & 0.00089 \\
    1 & 8 & 0.01 & 0.01218 & 0.00313 & 0.00229 \\
    1 & 8 & 0.1 & 0.02064 & 0.02415 & 0.02420 \\
    1 & 16 & 0.001 & 6.21736E-05 & 7.85435E-05 & 6.44446E-05 \\
    1 & 16 & 0.01 & 0.00059 & 0.00119 & 8.35920E-05 \\
    1 & 16 & 0.1 & 0.02056 & 0.02415 & 0.02420 \\
    1 & 32 & 0.001 & 1.33441E-05 & \textbf{2.31054E-05} & 4.27180E-05 \\
    1 & 32 & 0.01 & \textbf{5.57840E-06} & \textbf{1.32064E-05} & \textbf{2.49582E-05} \\
    1 & 32 & 0.1 & 0.02415E-05 & 0.02062 & 0.02420 \\

    % 2 capas ocultas
    2 & 8 & 0.001 & 0.00094 & 0.00043 & 0.00085 \\
    2 & 8 & 0.01 & 0.00673 & 0.00332 & 0.00327 \\
    2 & 8 & 0.1 & 0.02428 & 0.02430 & 0.02063 \\
    2 & 16 & 0.001 & 1.96797E-05 & 2.97114E-05 & 0.00013 \\
    2 & 16 & 0.01 & 0.00042 & 0.00040 & 0.00089 \\
    2 & 16 & 0.1 & 0.01624 & 0.02422 & 0.01343 \\
    2 & 32 & 0.001 & 8.32571E-06 & \textbf{2.15010E-05} & 3.63325E-05 \\
    2 & 32 & 0.01 & \textbf{5.56436E-06} & 5.32363E-05 & \textbf{2.65348E-05} \\
    2 & 32 & 0.1 & 0.02032 & 0.02060 & 0.02043 \\

    % 3 capas ocultas
    3 & 8 & 0.001 & 0.00152 & 0.00283 & 0.00195 \\
    3 & 8 & 0.01 & 0.00168 & 0.00284 & 0.00188 \\
    3 & 8 & 0.1 & 0.02417 & 0.02428 & 0.02041 \\
    3 & 16 & 0.001 & 5.74476E-05 & 5.53494E-05 & 0.00016 \\
    3 & 16 & 0.01 & 0.00031 & 0.00015 & 0.00095 \\
    3 & 16 & 0.1 & 0.02035 & 0.02036 & 0.01269 \\
    3 & 32 & 0.001 & \textbf{6.49630E-06} & \textbf{2.14812E-05} & \textbf{3.33377E-05} \\
    3 & 32 & 0.01 & \textbf{6.91262E-06} & 3.07683E-05 & \textbf{2.54072E-05} \\
    3 & 32 & 0.1 & 0.02028 & 0.01674 & 0.01653 \\
}

